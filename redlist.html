<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IMBR – Recrutas Ativos</title>

<link rel="stylesheet" href="style.css" />

</head>

<body>

<header>IMBR · Recrutas Ativos</header>

<section class="lineup-card">
  <h2 class="lineup-title">Recrutas com menos de 30 jogos</h2>
  <p>Filtro automático baseado na planilha oficial do Clan IMBR.</p>

  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th>Jogador</th>
          <th>Partidas (30d)</th>
          <th>Dias no Clan</th>
          <th>Perfil</th>
        </tr>
      </thead>
      <tbody id="recrutas-body"></tbody>
    </table>
  </div>
</section>


<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTihzZmyAJhTVjALmuX1R1YTGyuW0p-5umWppci2rQVRMJ5h1m2IrkZo4wi4MUN_fZ03vxu2vwFT2ob/pub?gid=1146212629&single=true&output=csv";

// Função de cor das partidas
function colorMatches(td, value) {
  const n = parseInt(value.replace("+","").trim());
  if (isNaN(n)) return;

  if (n === 0) td.classList.add("matches-red");
  else if (n < 30) td.classList.add("matches-mid");
  else td.classList.add("matches-green");
}

fetch(CSV_URL)
  .then(r => r.text())
  .then(csv => {
    const tbody = document.getElementById("recrutas-body");
    const linhas = csv.trim().split("\n").slice(1);

    linhas.forEach(linha => {
      const cols = linha.split(",");
      const nome   = cols[0].trim();
      const role   = cols[1].trim();
      const jogos  = cols[4].trim();
      const dias   = cols[5].trim();
      const perfil = cols[6].trim();

      if (!nome) return;

      const partidas = parseInt(jogos.replace("+","").trim());

      // FILTRO DA NOVA PÁGINA
      if (role === "Recruta" && partidas < 30) {

        const tr = document.createElement("tr");

        tr.innerHTML = `
          <td>${nome}</td>
          <td class="match-cell">${jogos}</td>
          <td>${dias}</td>
          <td><a href="${perfil}" target="_blank" style="color:#f5c542">Ver perfil</a></td>
        `;

        tbody.appendChild(tr);

        // aplicar cor
        colorMatches(tr.querySelector(".match-cell"), jogos);
      }
    });
  });
</script>

</body>
</html>
